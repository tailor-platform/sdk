const e=async e=>{let t=await e.client.execOne(`SELECT name FROM User ORDER BY createdAt DESC`);return t?t.name:`no user found`},t=async e=>{let t=e?new tailordb.Client({namespace:e}):{connect:()=>{},end:()=>{}};await t.connect();let n={async exec(e,n){return(await t.queryObject(e,n??[])).rows},async execOne(e,n){return(await t.queryObject(e,n??[])).rows[0]}};return{...n,async transaction(e){try{await n.exec(`BEGIN`);let t=await e(n);return await n.exec(`COMMIT`),t}catch(e){console.error(`Transaction failed:`,e);try{await n.exec(`ROLLBACK`)}catch(e){console.error(`Failed to rollback transaction:`,e)}}},async end(){try{await t.end()}catch(e){console.error(`Error ending connection:`,e)}}}};globalThis.main=await(async(e,n)=>async r=>{let i=await t(e);try{return await n({...r,client:i})}finally{await i.end()}})(`tailordb`,e);
//# sourceMappingURL=stepChain__sqlStep.js.map