var e=async({newRecord:e,client:t})=>{let n=await t.execOne(`select * from User where id = ?`,[e.id]);console.log(`New user created: ${n.name} (${n.email})`)};const t=async t=>{await e(t)},n=async e=>{let t=e?new tailordb.Client({namespace:e}):{connect:()=>{},end:()=>{}};await t.connect();let n={async exec(e,n){return(await t.queryObject(e,n??[])).rows},async execOne(e,n){return(await t.queryObject(e,n??[])).rows[0]}};return{...n,async transaction(e){try{await n.exec(`BEGIN`);let t=await e(n);return await n.exec(`COMMIT`),t}catch(e){console.error(`Transaction failed:`,e);try{await n.exec(`ROLLBACK`)}catch(e){console.error(`Failed to rollback transaction:`,e)}}},async end(){try{await t.end()}catch(e){console.error(`Error ending connection:`,e)}}}};globalThis.main=await(async(e,t)=>async r=>{let i=await n(e);try{return await t({...r,client:i})}finally{await i.end()}})(`tailordb`,t);
//# sourceMappingURL=user-created.js.map