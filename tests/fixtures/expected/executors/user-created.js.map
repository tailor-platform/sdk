{"version":3,"file":"user-created.js","sources":["user-created.transformed.js","../executor_steps/user-created.js"],"sourcesContent":["import { user } from \"src/tailordb/user\";\n\n//#region src/executors/userCreated.ts\n\n//#endregion\n\n// Export the executor function\nexport const __executor_function = async({newRecord,client})=>{const record=await client.execOne(`select * from User where id = '${newRecord.id}'`);console.log(`New user created: ${record.name} (${record.email})`)};","import { __executor_function } from \"../executors/user-created.transformed.js\";\n\nconst $connect_tailordb = async (namespace) => {\n  const baseClient = new tailordb.Client({ namespace });\n  if (namespace) {\n    await baseClient.connect();\n  }\n  const client = {\n    async exec(query) {\n      const result = await baseClient.queryObject(query);\n      return result.rows;\n    },\n    async execOne(query) {\n      const result = await baseClient.queryObject(query);\n      return result.rows[0];\n    },\n  };\n  return {\n    ...client,\n    async transaction(callback) {\n      try {\n        await client.exec(\"BEGIN\");\n        const result = await callback(client);\n        await client.exec(\"COMMIT\");\n        return result;\n      } catch (e) {\n        console.error(\"Transaction failed:\", e);\n        try {\n          await client.exec(\"ROLLBACK\");\n        } catch (e) {\n          console.error(\"Failed to rollback transaction:\", e);\n        }\n      }\n    }\n  };\n};\n\nconst $tailor_db_wrapper = async (namespace, fn) => {\n  const client = await $connect_tailordb(namespace);\n  return async (args) => await fn({ ...args, db: client, client });\n};\nglobalThis.main = await $tailor_db_wrapper(\"tailordb\", __executor_function);"],"names":["newRecord","client","record","namespace","baseClient","query","callback","result","e","fn","args"],"mappings":"AAOO,MAAM,oBAAsB,MAAM,CAAC,UAAAA,EAAU,OAAAC,CAAM,IAAI,CAAC,MAAMC,EAAO,MAAMD,EAAO,QAAQ,kCAAkCD,EAAU,EAAE,GAAG,EAAE,QAAQ,IAAI,qBAAqBE,EAAO,IAAI,KAAKA,EAAO,KAAK,GAAG,CAAC,ECL/M,kBAAoB,MAAOC,GAAc,CAC7C,MAAMC,EAAa,IAAI,SAAS,OAAO,CAAE,UAAAD,CAAS,CAAE,EAElD,MAAMC,EAAW,QAAS,EAE5B,MAAMH,EAAS,CACb,MAAM,KAAKI,EAAO,CAEhB,OADe,MAAMD,EAAW,YAAYC,CAAK,GACnC,IACf,EACD,MAAM,QAAQA,EAAO,CAEnB,OADe,MAAMD,EAAW,YAAYC,CAAK,GACnC,KAAK,CAAC,CACrB,CACF,EACD,MAAO,CACL,GAAGJ,EACH,MAAM,YAAYK,EAAU,CAC1B,GAAI,CACF,MAAML,EAAO,KAAK,OAAO,EACzB,MAAMM,EAAS,MAAMD,EAASL,CAAM,EACpC,aAAMA,EAAO,KAAK,QAAQ,EACnBM,CACR,OAAQC,EAAG,CACV,QAAQ,MAAM,sBAAuBA,CAAC,EACtC,GAAI,CACF,MAAMP,EAAO,KAAK,UAAU,CAC7B,OAAQO,EAAG,CACV,QAAQ,MAAM,kCAAmCA,CAAC,CAC5D,CACA,CACA,CACG,CACH,EAEM,mBAAqB,MAAOL,EAAWM,IAAO,CAClD,MAAMR,EAAS,MAAM,kBAAkBE,CAAS,EAChD,MAAO,OAAOO,GAAS,MAAMD,EAAG,CAAE,GAAGC,EAAM,GAAIT,EAAQ,OAAAA,EAAQ,CACjE,EACA,WAAW,KAAO,MAAM,mBAAmB,WAAY,mBAAmB"}